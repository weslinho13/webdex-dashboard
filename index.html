   <!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Interface WEbdEX Manager</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 1rem; background:#f5f5f5; }
  h1 { text-align: center; }
  .section { background: white; margin: 1rem 0; padding: 1rem; border-radius: 8px; box-shadow: 0 0 5px #ccc; }
  label { display: block; margin-top: 0.8rem; font-weight: bold; }
  input[type="number"] { width: 100%; padding: 0.5rem; font-size: 1rem; margin-top: 0.3rem; }
  button { margin-top: 0.8rem; padding: 0.6rem 1.2rem; font-size: 1rem; cursor: pointer; border-radius: 5px; border: none; background-color: #007bff; color: white; }
  button:disabled { background-color: #999; cursor: not-allowed; }
  #status { margin-top: 1rem; padding: 0.8rem; border-radius: 5px; min-height: 24px; }
  .saldo { font-size: 1.2rem; margin: 0.3rem 0 0.8rem 0; }
</style>
</head>
<body>

<h1>WEbdEX Manager</h1>

<div class="section">
  <button id="connectWalletBtn">Conectar MetaMask</button>
  <div id="walletAddress"></div>
</div>

<div class="section">
  <h2>Saldos</h2>
  <div><strong>Saldo Gás:</strong> <span id="gasBalance">-</span></div>
  <div><strong>Saldo Pass (WebdEX):</strong> <span id="passBalance">-</span></div>
  <div><strong>Saldo Liquidez:</strong> <span id="liquidityBalance">-</span></div>
</div>

<div class="section">
  <h2>Adicionar/Remover Gás</h2>
  <label for="gasAmount">Quantidade (wei):</label>
  <input type="number" id="gasAmount" min="0" placeholder="Digite o valor" />
  <button id="addGasBtn">Adicionar Gás</button>
  <button id="removeGasBtn">Remover Gás</button>
</div>

<div class="section">
  <h2>Adicionar/Remover Pass (WebdEX)</h2>
  <label for="passAmount">Quantidade (uint):</label>
  <input type="number" id="passAmount" min="0" placeholder="Digite o valor" />
  <button id="addPassBtn">Adicionar Pass</button>
  <button id="removePassBtn">Remover Pass</button>
</div>

<div class="section">
  <h2>Adicionar/Remover Liquidez</h2>
  <label for="liquidityAmount">Quantidade (wei):</label>
  <input type="number" id="liquidityAmount" min="0" placeholder="Digite o valor" />
  <button id="addLiquidityBtn">Adicionar Liquidez</button>
  <button id="removeLiquidityBtn">Remover Liquidez</button>
</div>

<div class="section">
  <h2>Outras Ações</h2>
  <button id="pauseBtn">Pausar</button>
  <button id="stopBtn">Parar</button>
  <button id="rebalanceBtn">Rebalancear</button>
</div>

<div id="status"></div>

<script>
  const contractAddress = "0x9b4314878f58C3Ca53EC0087AcC8c9A30DF773E0";
  const contractABI = [
    // ABI resumido com as funções citadas - ajuste conforme seu ABI completo
    "function gasBalance() view returns (uint256)",
    "function passBalance() view returns (uint256)",
    "function liquidityBalance() view returns (uint256)",
    "function gasAdd(uint256 amount) external",
    "function gasRemove(uint256 amount) external",
    "function passAdd(uint256 amount) external",
    "function passRemove(uint256 amount) external",
    "function liquidityAdd(uint256 amount) external",
    "function liquidityRemove(uint256 amount) external",
    "function pause() external",
    "function stop() external",
    "function rebalance() external"
  ];

  let provider;
  let signer;
  let contract;

  const connectWalletBtn = document.getElementById("connectWalletBtn");
  const walletAddressDiv = document.getElementById("walletAddress");
  const statusDiv = document.getElementById("status");

  const gasBalanceSpan = document.getElementById("gasBalance");
  const passBalanceSpan = document.getElementById("passBalance");
  const liquidityBalanceSpan = document.getElementById("liquidityBalance");

  connectWalletBtn.onclick = async () => {
    if (typeof window.ethereum === 'undefined') {
      alert("MetaMask não detectado!");
      return;
    }
    try {
      await window.ethereum.request({ method: 'eth_requestAccounts' });
      provider = new ethers.providers.Web3Provider(window.ethereum);
      signer = provider.getSigner();
      contract = new ethers.Contract(contractAddress, contractABI, signer);

      const address = await signer.getAddress();
      walletAddressDiv.textContent = "Conectado: " + address;

      statusDiv.textContent = "Carregando saldos...";
      await atualizarSaldos();
      statusDiv.textContent = "Saldos atualizados!";
    } catch (error) {
      console.error(error);
      statusDiv.textContent = "Erro ao conectar MetaMask: " + error.message;
    }
  };

  async function atualizarSaldos() {
    try {
      const gas = await contract.gasBalance();
      const pass = await contract.passBalance();
      const liquidity = await contract.liquidityBalance();

      gasBalanceSpan.textContent = ethers.utils.formatUnits(gas, 18);
      passBalanceSpan.textContent = pass.toString();
      liquidityBalanceSpan.textContent = ethers.utils.formatUnits(liquidity, 18);
    } catch (error) {
      console.error(error);
      statusDiv.textContent = "Erro ao buscar saldos: " + error.message;
    }
  }

  // Função auxiliar para executar transações
  async function executarTx(funcName, amount) {
    if (!contract) {
      alert("Conecte a MetaMask primeiro.");
      return;
    }
    try {
      statusDiv.textContent = `Enviando transação ${funcName}...`;
      let tx;
      if(amount !== undefined) {
        tx = await contract[funcName](amount);
      } else {
        tx = await contract[funcName]();
      }
      await tx.wait();
      statusDiv.textContent = `${funcName} executado com sucesso! Atualizando saldos...`;
      await atualizarSaldos();
    } catch (error) {
      console.error(error);
      statusDiv.textContent = `Erro na transação ${funcName}: ${error.message}`;
    }
  }

  // Eventos dos botões de adicionar/remover com valor digitado
  document.getElementById("addGasBtn").onclick = () => {
    const val = document.getElementById("gasAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Gás");
    const amount = ethers.utils.parseUnits(val, 18);
    executarTx("gasAdd", amount);
  };

  document.getElementById("removeGasBtn").onclick = () => {
    const val = document.getElementById("gasAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Gás");
    const amount = ethers.utils.parseUnits(val, 18);
    executarTx("gasRemove", amount);
  };

  document.getElementById("addPassBtn").onclick = () => {
    const val = document.getElementById("passAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Pass");
    const amount = ethers.BigNumber.from(val);
    executarTx("passAdd", amount);
  };

  document.getElementById("removePassBtn").onclick = () => {
    const val = document.getElementById("passAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Pass");
    const amount = ethers.BigNumber.from(val);
    executarTx("passRemove", amount);
  };

  document.getElementById("addLiquidityBtn").onclick = () => {
    const val = document.getElementById("liquidityAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Liquidez");
    const amount = ethers.utils.parseUnits(val, 18);
    executarTx("liquidityAdd", amount);
  };

  document.getElementById("removeLiquidityBtn").onclick = () => {
    const val = document.getElementById("liquidityAmount").value;
    if(!val || val <= 0) return alert("Digite um valor válido para Liquidez");
    const amount = ethers.utils.parseUnits(val, 18);
    executarTx("liquidityRemove", amount);
  };

  // Botões pausar, parar, rebalancear
  document.getElementById("pauseBtn").onclick = () => executarTx("pause");
  document.getElementById("stopBtn").onclick = () => executarTx("stop");
  document.getElementById("rebalanceBtn").onclick = () => executarTx("rebalance");
</script>

</body>
</html>
