
 <!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Saldo Token LP</title>
<script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  #saldo { font-size: 1.5em; margin-top: 20px; }
  button { padding: 10px 20px; font-size: 1em; cursor: pointer; }
</style>
</head>
<body>

<h1>Verificar Saldo Token LP</h1>
<button id="btnConectar">Conectar MetaMask</button>

<div id="saldo"></div>

<script>
  const tokenAddress = '0x72F95e2E7b81A6ede5207C7Bd14881c84555C411';

  // ABI mínimo ERC20 para balanceOf e decimals
  const minABI = [
    // balanceOf
    {
      constant: true,
      inputs: [{ name: "_owner", type: "address" }],
      name: "balanceOf",
      outputs: [{ name: "balance", type: "uint256" }],
      type: "function",
    },
    // decimals
    {
      constant: true,
      inputs: [],
      name: "decimals",
      outputs: [{ name: "", type: "uint8" }],
      type: "function",
    },
    // name
    {
      constant: true,
      inputs: [],
      name: "name",
      outputs: [{ name: "", type: "string" }],
      type: "function",
    },
    // symbol
    {
      constant: true,
      inputs: [],
      name: "symbol",
      outputs: [{ name: "", type: "string" }],
      type: "function",
    }
  ];

  let web3;
  let contract;
  let userAddress;

  async function connect() {
    if (window.ethereum) {
      try {
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        web3 = new Web3(window.ethereum);

        const accounts = await web3.eth.getAccounts();
        userAddress = accounts[0];

        contract = new web3.eth.Contract(minABI, tokenAddress);

        document.getElementById('btnConectar').textContent = 'Conectado: ' + userAddress;
        document.getElementById('btnConectar').disabled = true;

        mostrarSaldo();

        // Atualiza saldo se trocar conta na MetaMask
        window.ethereum.on('accountsChanged', function (accounts) {
          userAddress = accounts[0];
          mostrarSaldo();
          document.getElementById('btnConectar').textContent = 'Conectado: ' + userAddress;
        });

      } catch (error) {
        alert('Erro ao conectar: ' + error.message);
      }
    } else {
      alert('MetaMask não detectada. Instale e ative-a para continuar.');
    }
  }

  async function mostrarSaldo() {
    try {
      const balance = await contract.methods.balanceOf(userAddress).call();
      const decimals = await contract.methods.decimals().call();
      const name = await contract.methods.name().call();
      const symbol = await contract.methods.symbol().call();

      const formattedBalance = balance / (10 ** decimals);

      document.getElementById('saldo').innerHTML = `
        <strong>${name} (${symbol})</strong><br>
        Saldo: ${formattedBalance.toLocaleString('pt-BR')}
      `;

    } catch (error) {
      document.getElementById('saldo').textContent = 'Erro ao consultar saldo.';
      console.error(error);
    }
  }

  document.getElementById('btnConectar').onclick = connect;
</script>

</body>
</html>
